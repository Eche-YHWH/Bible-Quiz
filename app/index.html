<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Acts Quiz Arcade</title>
    <link rel="stylesheet" href="./src/styles.css" />
    <link rel="manifest" href="./manifest.webmanifest" />
    <meta name="theme-color" content="#f3c98a" />
    <link rel="icon" href="./assets/icon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="./assets/icon.svg" />
  </head>
  <body class="bg-art">
    <div id="confetti" class="confetti hidden" aria-hidden="true"></div>

    <!-- Menu Screen -->
    <div id="menu" class="overlay is-visible" role="dialog" aria-modal="true" aria-label="Main menu">
      <div class="paper panel" tabindex="-1">
        <div class="panel-header">
          <div>
            <h2 class="panel-title">Acts Quiz Arcade</h2>
            <p class="panel-subtitle">Pick a mode.</p>
          </div>
          <div class="panel-icon" aria-hidden="true">ü™Ö</div>
        </div>

        <div class="panel-actions">
          <button id="btnNewGame" class="answer">New game</button>
          <button id="btnContinue" class="answer">Continue</button>
        </div>

        <div class="badge panel-stats">
          <div class="row-between">
            <span>Best</span>
            <span id="bestScoreMenu" class="value">0</span>
          </div>
          <div class="row-between">
            <span>Saved run</span>
            <span id="saveStatus" class="value">None</span>
          </div>
          <div id="saveMeta" class="menu-meta"></div>
        </div>

        <p class="panel-tip">Tip: Keep a streak. Every 3 correct gives a bonus.</p>
      </div>
    </div>

    <!-- Book Map -->
    <div id="bookMap" class="overlay" role="dialog" aria-modal="true" aria-label="Bible book map">
      <div class="paper panel" tabindex="-1">
        <div class="panel-header">
          <div>
            <h2 class="panel-title">Bible Book Map</h2>
            <p class="panel-subtitle">Pick a book to start.</p>
          </div>
          <button id="btnCloseMap" class="badge" aria-label="Back to menu">Back</button>
        </div>

        <div class="book-map">
          <svg class="map-path" viewBox="0 0 100 100" preserveAspectRatio="none" aria-hidden="true">
            <path d="M10 15 C 30 5, 45 25, 70 20 S 95 30, 85 40 C 75 52, 55 45, 45 60 S 30 75, 22 80 S 40 92, 72 88" />
          </svg>
          <div id="bookNodes" class="map-nodes"></div>
        </div>

        <div class="row-between map-meta">
          <span id="mapHint">Tap a book to begin.</span>
          <span id="selectedBookLabel" class="value"></span>
        </div>
      </div>
    </div>

    <!-- Pause Overlay -->
    <div id="pause" class="overlay" role="dialog" aria-modal="true" aria-label="Paused">
      <div class="paper panel pause-card" tabindex="-1">
        <div class="panel-header">
          <div>
            <h3 class="panel-title">Paused</h3>
            <p class="panel-subtitle">Take a breath. Resume anytime.</p>
          </div>
        </div>
        <div class="panel-actions">
          <button id="btnResume" class="answer">Resume</button>
          <button id="btnPauseRestart" class="answer">Restart run</button>
          <button id="btnPauseMenu" class="answer">Back to menu</button>
        </div>
      </div>
    </div>

    <!-- How to play + Settings -->
    <div id="modal" class="overlay" role="dialog" aria-modal="true" aria-labelledby="howTitle">
      <div class="paper panel modal-card" tabindex="-1">
        <div class="panel-header">
          <div>
            <h3 id="howTitle" class="panel-title">How to play</h3>
            <p class="panel-subtitle">Quick rules so you can start fast.</p>
          </div>
          <button id="btnClose" class="badge">Close</button>
        </div>

        <ul class="rules">
          <li>Questions are split into levels (6 each). Total varies by book.</li>
          <li>Correct answer: +10 points.</li>
          <li>Wrong answer: lose 1 life (you have 3).</li>
          <li>Streak bonus: every 3 correct in a row gives +5.</li>
          <li>Level-up pops confetti. Finish all questions to get your rank.</li>
          <li>Keyboard: A/B/C/D to answer, Enter for next.</li>
        </ul>

        <div class="settings">
          <h4 class="settings-title">Settings</h4>

          <div class="setting-row">
            <label class="setting-label" for="settingSound">Sound</label>
            <label class="toggle">
              <input id="settingSound" type="checkbox" />
              <span class="toggle-track" aria-hidden="true"></span>
            </label>
          </div>

          <div class="setting-row">
            <label class="setting-label" for="settingMusic">Music volume</label>
            <div class="setting-control">
              <input id="settingMusic" type="range" min="0" max="100" step="1" />
              <span id="settingMusicValue" class="setting-value">32</span>
            </div>
          </div>

          <div class="setting-row">
            <label class="setting-label" for="settingFx">FX volume</label>
            <div class="setting-control">
              <input id="settingFx" type="range" min="0" max="100" step="1" />
              <span id="settingFxValue" class="setting-value">90</span>
            </div>
          </div>

          <div class="setting-row">
            <label class="setting-label" for="settingMotion">Reduce motion</label>
            <label class="toggle">
              <input id="settingMotion" type="checkbox" />
              <span class="toggle-track" aria-hidden="true"></span>
            </label>
          </div>

          <p class="settings-note">Reduce motion disables confetti and shake effects.</p>
        </div>
      </div>
    </div>

    <!-- Streak popup (tap anywhere to continue) -->
    <div id="streakPop" class="overlay streak-pop" role="dialog" aria-modal="true" aria-label="Streak bonus">
      <img id="streakPopImg" src="./assets/streak_popup_transparent.png" alt="Streak bonus" />
    </div>

    <div id="toastHost" class="toast-host" aria-live="polite" aria-atomic="true"></div>

    <main class="app">
      <!-- HUD -->
      <header class="hud">
        <div class="hud-left">
          <div class="gem-icon" aria-hidden="true">üíé</div>
          <div class="badge gem-count">
            <span id="gemCount">9999</span>
          </div>
          <button id="btnAddGems" class="iconbtn" aria-label="Add gems" title="Bonus">Ôºã</button>
        </div>

        <div class="hud-right">
          <button id="btnPause" class="iconbtn" aria-label="Pause" title="Pause">‚è∏</button>
          <button id="btnReset" class="iconbtn" aria-label="Menu" title="Menu">‚Ü©</button>
          <button id="btnHow" class="iconbtn" aria-label="How to play and settings" title="How to play">‚öô</button>
        </div>
      </header>

      <!-- Progress -->
      <section class="progress">
        <div class="progress-row">
          <span class="star" aria-hidden="true">‚≠ê</span>
          <div class="track">
            <div id="progressFill" class="track-fill"></div>
          </div>
          <span class="star" aria-hidden="true">‚≠ê</span>
        </div>
        <div class="progress-meta">
          <span id="statBookName">Acts</span>
          <span id="statProgress">1/30</span>
        </div>
        <div id="statLevelName" class="progress-level">New Fire</div>
      </section>

      <!-- Question parchment -->
      <section id="paperCard" class="paper question-card">
        <p id="qText" class="question-text">Loading...</p>
        <div class="question-meta">
          <div id="statLives" class="lives"></div>
          <div class="badge timer">
            <span aria-hidden="true">‚è±</span>
            <span id="timerLabel">15s</span>
          </div>
        </div>
      </section>

      <!-- Answers leather board -->
      <section id="board" class="leather board">
        <div class="stitch board-inner">
          <div id="choices" class="choices"></div>
        </div>

        <div id="feedback" class="feedback hidden" role="status" aria-live="polite"></div>

        <div class="board-actions">
          <button id="btnNext" class="answer hidden">Next</button>
          <button id="btnRestart" class="answer hidden">Play again</button>
        </div>

        <div class="board-stats">
          <div class="badge">
            <span class="label">Score:</span> <span id="statScore" class="value">0</span>
            <span class="sep">|</span>
            <span class="label">Streak:</span> <span id="statStreak" class="value">0</span>
          </div>
          <button id="btnSound" class="badge sound-toggle" aria-label="Toggle sound">Sound: On</button>
        </div>

        <div class="board-footer">
          <span><strong>Best:</strong> <span id="bestScore">0</span></span>
          <span class="sep">|</span>
          <span><strong>Rank:</strong> <span id="rank">Fresh Learner</span></span>
        </div>
      </section>
    </main>

    <script type="module" src="./src/main.js"></script>
  </body>
</html>
